---
interface Props {
  src: string;
  alt: string;
  caption?: string;
  type?: 'EVIDENCE' | 'SCHEMATIC' | 'SCREENSHOT';
}

const { src, alt, caption, type = 'EVIDENCE' } = Astro.props;
---

<figure class="my-12 font-mono group">
    
    {/* LABEL HEADER */}
    <div class="flex items-center gap-4 mb-2 text-[10px] tracking-widest text-primary/60 max-w-2xl mx-auto">
        <span class="bg-primary/10 px-2 py-0.5 border border-primary/20">{type}</span>
        <div class="h-px bg-primary/20 flex-grow"></div>
        <span class="uppercase opacity-50">FIG_1.{Math.floor(Math.random() * 9)}</span>
    </div>

    {/* IMAGE CONTAINER */}
    <div class="relative border-2 border-white/10 bg-black/50 overflow-hidden max-w-4xl mx-auto">
        
        {/* CORNER MARKERS */}
        <div class="absolute top-0 left-0 w-3 h-3 border-t-2 border-l-2 border-white/30 z-20"></div>
        <div class="absolute top-0 right-0 w-3 h-3 border-t-2 border-r-2 border-white/30 z-20"></div>
        <div class="absolute bottom-0 left-0 w-3 h-3 border-b-2 border-l-2 border-white/30 z-20"></div>
        <div class="absolute bottom-0 right-0 w-3 h-3 border-b-2 border-r-2 border-white/30 z-20"></div>
        
        {/* SCANLINE OVERLAY */}
        <div class="absolute inset-0 bg-[linear-gradient(rgba(18,16,16,0)_50%,rgba(0,0,0,0.25)_50%),linear-gradient(90deg,rgba(255,0,0,0.06),rgba(0,255,0,0.02),rgba(0,0,255,0.06))] z-10 bg-[length:100%_2px,3px_100%] pointer-events-none opacity-20 group-hover:opacity-10 transition-opacity duration-500"></div>

        <img 
            src={src} 
            alt={alt} 
            class="w-full h-auto grayscale-[20%] contrast-125 brightness-90 group-hover:grayscale-0 group-hover:brightness-100 transition-all duration-700 ease-out"
        />

        {/* GLITCH TEXTURE */}
        <div class="absolute inset-0 mix-blend-overlay opacity-0 group-hover:opacity-20 transition-opacity duration-300 pointer-events-none" style="background-image: url('/assets/noise.svg');"></div>
    </div>

    {/* CAPTION */}
    {caption && (
        <figcaption class="mt-3 text-center text-xs text-white/40 max-w-2xl mx-auto italic border-l-2 border-white/10 pl-4 py-1">
            ^ {caption}
        </figcaption>
    )}
</figure>
